# üéâ –§–ò–ù–ê–õ–¨–ù–û–ï –†–ï–ó–Æ–ú–ï –í–°–ï–• –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

## –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã (–ò–°–ü–†–ê–í–õ–ï–ù–´):

### 1. ‚úÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≤—ã–∑—ã–≤–∞–ª–∞ –ø–µ—Ä–µ—Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –¥–∞–Ω–Ω—ã—Ö
**–§–∞–π–ª:** [pysheets/src/ui/spreadsheet_widget.py](pysheets/src/ui/spreadsheet_widget.py#L77-L79)

–ü—Ä–æ–±–ª–µ–º–∞: `setSortingEnabled(True)` –≤ init_ui() –≤—ã–∑—ã–≤–∞–ª–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–µ –ø–æ—Ä—è–¥–∫–∞ —è—á–µ–µ–∫ (12345 ‚Üí 3214).

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –û—Ç–∫–ª—é—á–µ–Ω–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞

---

### 2. ‚úÖ load_data() —Ç–µ—Ä—è–ª–∞ –¥–∞–Ω–Ω—ã–µ
**–§–∞–π–ª:** [pysheets/src/ui/spreadsheet_widget.py](pysheets/src/ui/spreadsheet_widget.py#L504-L528)

–ü—Ä–æ–±–ª–µ–º–∞: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è `self.cells` –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–∞ –ü–û–°–õ–ï –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö.

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –ü–µ—Ä–µ–º–µ—Å—Ç–∏–ª–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –ü–ï–†–ï–î –∑–∞–≥—Ä—É–∑–∫–æ–π

---

### 3. ‚úÖ –§–æ—Ä–º—É–ª—ã –Ω–µ –≤—ã—á–∏—Å–ª—è–ª–∏—Å—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ
**–§–∞–π–ª:** [pysheets/src/core/formula_engine.py](pysheets/src/core/formula_engine.py#L350)

–ü—Ä–æ–±–ª–µ–º–∞: –ü—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è 0-based –∏–Ω–¥–µ–∫—Å –≤–º–µ—Å—Ç–æ 1-based.

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –î–æ–±–∞–≤–ª–µ–Ω–æ +1 –ø—Ä–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏

---

### 4. ‚úÖ Corner button –Ω–µ —Å—Ç–∏–ª–∏–∑–æ–≤–∞–ª—Å—è (–ü–ï–†–ï–ò–°–ü–†–ê–í–õ–ï–ù–û)
**–§–∞–π–ª:** [pysheets/src/ui/spreadsheet_widget.py](pysheets/src/ui/spreadsheet_widget.py#L85-L119)
**–§–∞–π–ª:** [pysheets/src/ui/themes.py](pysheets/src/ui/themes.py#L67-L68, #L130-L131)

–ü—Ä–æ–±–ª–µ–º–∞: CSS —Å–µ–ª–µ–∫—Ç–æ—Ä –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –∫–Ω–æ–ø–∫–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–ª–æ–π –ø—Ä–∏ —Ç–µ–º–Ω–æ–π —Ç–µ–º–µ.

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: 
- –ü–µ—Ä–µ–ø–∏—Å–∞–Ω –º–µ—Ç–æ–¥ `_style_corner_button()` - —Ç–µ–ø–µ—Ä—å –Ω–∞—Ö–æ–¥–∏—Ç –∏ —Å—Ç–∏–ª–∏–∑—É–µ—Ç –∫–Ω–æ–ø–∫—É –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ
- –î–æ–±–∞–≤–ª–µ–Ω—ã QHeaderView –∏ QAbstractButton —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –≤ CSS
- –î–æ–±–∞–≤–ª–µ–Ω–æ —è–≤–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ —Ñ–æ–∫—É—Å–∞ –¥–ª—è –∫–Ω–æ–ø–∫–∏

---

### 5. ‚úÖ Zoom –Ω–µ —Ä–∞–±–æ—Ç–∞–ª (–ü–ï–†–ï–ò–°–ü–†–ê–í–õ–ï–ù–û)
**–§–∞–π–ª:** [pysheets/src/ui/main_window.py](pysheets/src/ui/main_window.py#L547-L554)

–ü—Ä–æ–±–ª–µ–º–∞: zoom_combo_changed() –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–ª–∞.

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞:
```python
def zoom_combo_changed(self, value):
    if value.endswith("%"):
        zoom_value = int(value[:-1])
        spreadsheet = self.get_current_spreadsheet()
        if spreadsheet:
            spreadsheet.zoom_level = zoom_value
            spreadsheet.apply_zoom()
```

---

### 6. ‚úÖ –û—à–∏–±–∫–∞ –≤ apply_theme()
**–§–∞–π–ª:** [pysheets/src/ui/main_window.py](pysheets/src/ui/main_window.py#L796)

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π —Å `self.tabs` –Ω–∞ `self.tab_widget`

---

## –§–∏–Ω–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

‚úÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞ - –ø–æ—Ä—è–¥–æ–∫ –¥–∞–Ω–Ω—ã—Ö —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
‚úÖ load_data() —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ –Ω—É–∂–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
‚úÖ –§–æ—Ä–º—É–ª—ã –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è - SUM, AVERAGE, COUNT –∏ —Ç.–¥.
‚úÖ Corner button —Ç–µ–ø–µ—Ä—å —Ç–µ–º–Ω—ã–π –≤ —Ç–µ–º–Ω–æ–π —Ç–µ–º–µ –∏ —Å–≤–µ—Ç–ª—ã–π –≤ —Å–≤–µ—Ç–ª–æ–π
‚úÖ Zoom —Ä–∞–±–æ—Ç–∞–µ—Ç - 100%, 200% –∏ —Ç.–¥. –º–µ–Ω—è—é—Ç —Ä–∞–∑–º–µ—Ä —Ç–∞–±–ª–∏—Ü—ã
‚úÖ apply_theme() –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ - –ø–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç corner button –≤–æ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö

---

## –§–∞–π–ª—ã –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω—ã:

1. `pysheets/src/ui/spreadsheet_widget.py`
   - –û—Ç–∫–ª—é—á–µ–Ω–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ (—Å—Ç—Ä–æ–∫–∞ 77-79)
   - –ü–µ—Ä–µ–º–µ—Å—Ç–æ–≤–∞–Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è self.cells (—Å—Ç—Ä–æ–∫–∞ 504-528)
   - –ü–µ—Ä–µ–ø–∏—Å–∞–Ω –º–µ—Ç–æ–¥ _style_corner_button() (—Å—Ç—Ä–æ–∫–∞ 85-119)
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω apply_zoom() (—Å—Ç—Ä–æ–∫–∞ 490-505)

2. `pysheets/src/core/formula_engine.py`
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ (—Å—Ç—Ä–æ–∫–∞ 350, –¥–æ–±–∞–≤–ª–µ–Ω–æ +1)

3. `pysheets/src/ui/main_window.py`
   - –ü–µ—Ä–µ–ø–∏—Å–∞–Ω zoom_combo_changed() (—Å—Ç—Ä–æ–∫–∞ 547-554)
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω apply_theme() (—Å—Ç—Ä–æ–∫–∞ 796, self.tabs ‚Üí self.tab_widget)

4. `pysheets/src/ui/themes.py`
   - –î–æ–±–∞–≤–ª–µ–Ω—ã —Å–µ–ª–µ–∫—Ç–æ—Ä—ã QHeaderView –∏ QAbstractButton –¥–ª—è light –∏ dark —Ç–µ–º
   - –£–¥–∞–ª–µ–Ω—ã –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è —Å—Ç–∏–ª–∏ –≤ —Ç–µ–º–Ω–æ–π —Ç–µ–º–µ

---

## –í—Å–µ –≥–æ—Ç–æ–≤–æ! ‚úÖ

–ü—Ä–æ–±–ª–µ–º—ã —Ä–µ—à–µ–Ω—ã:
1. **–ë–µ–ª—ã–π –∫–≤–∞–¥—Ä–∞—Ç** - —Ç–µ–ø–µ—Ä—å —Ç–µ–º–Ω—ã–π –ø—Ä–∏ —Ç–µ–º–Ω–æ–π —Ç–µ–º–µ
2. **Zoom** - —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –ø—Ä–æ—Ü–µ–Ω—Ç—ã

